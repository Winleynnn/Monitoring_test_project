<div class="select">
	<input class="select__input" type="hidden" name="">
	<div class="select__head">0020CF3B</div>
	<ul class="select__list" style="display: none;">
		<option class="select__item">0020CF3B</option>
		<option class="select__item">002099C5</option>
	</ul>
</div>
<div class="tabs">
	<ul class="tab-links">
		<li class="active" onmousedown="return false"><a href="#tab1">Графики</a></li>
		<li  onmousedown="return false"><a href="#tab2">Таблицы</a></li>
	</ul>

	<div class="tab-content">
		<div id="tab1" class="tab active">
			<div class="graphic">
				<canvas id="myChart" class="chart1" height= "70px"></canvas>
				<canvas id="myChart2" class="chart2" height= "70px"></canvas>
		</div>
		</div>

		<div id="tab2" class="tab"> 
			<table class="table" id="myTable">
				<tbody>
					<thead>
					<tr>
						<th onclick="sortTable(0)">Дата </th>
						<th onclick="sortTable(1)">Средняя температура воздуха, °C</th>
						<th onclick="sortTable(2)">Относительная влажность воздуха, %</th>
						<th onclick="sortTable(3)">Средняя температура почвы, °C</th>
						<th onclick="sortTable(4)">Влажность почвы, %</th>
					</tr>
					</thead>
					{% for a in data %}
					<tr>
						<td>{{a.date}}</td>
						<td>{{a.air_temp_avg}}</td>
						<td>{{a.relative_humidity_avg}}</td>
						<td>{{a.soil_temp_avg}}</td>
						<td>{{a.soil_moisture}}</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
</div>
  
<div class="display">
	<script src="https://code.jquery.com/jquery-3.3.1.min.js" ></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
	<script type = "text/javascript">
		  const ctx = document.getElementById('myChart').getContext('2d');
		  const myChart = new Chart(ctx, {
			  type: 'line',
			  data: {														
				  labels: [
					  {% for a in data %}
					  '{{a.date}}',{% endfor %}
				  ],
				  datasets: [
					  {
						  label: 'Средняя температура воздуха, °C',
						  data: [
							  {% for a in data %}
							  {{a.air_temp_avg}},{% endfor %}
						  ],
						  backgroundColor: ['rgba(255, 255,255, 0.2)'],
						  borderColor: ['rgba(200, 0, 15, 1)'],
						  borderWidth: 2
					  },						
					  {
						  label: 'Средняя температура почвы, °C',
						  data: [
							  {% for a in data %}
							  {{a.soil_temp_avg}},{% endfor %}
						  ],
						  backgroundColor: ['rgba(255, 255, 255, 0.2)'],
						  borderColor: ['rgba(9, 132, 0, 1)'],
						  
						  borderWidth: 2
					  },	
				  ]
					  },
			  options: {
				  scales: {
					  y: {
						  beginAtZero: true
					  }
				  }
			  }				
		  });				
		  const ctx2 = document.getElementById('myChart2').getContext('2d');
		  const myChart2 = new Chart(ctx2, {
			  type: 'line',
			  data: {														
				  labels: [
					  {% for a in data %}
					  '{{a.date}}',{% endfor %}
				  ],
				  datasets: [
					  {
						  label: 'Относительная влажность воздуха, %',
						  data: [
							  {% for a in data %}
							  {{a.relative_humidity_avg}},{% endfor %}
						  ],
						  backgroundColor: ['rgba(255, 255, 255, 0.2)'],
						  borderColor: ['rgba(200, 0, 15, 1)'],
						  borderWidth: 2
					  },						
					  {
						  label: 'Средняя влажность почвы, %',
						  data: [
							  {% for a in data %}
							  {{a.soil_moisture}},{% endfor %}
						  ],
						  backgroundColor: ['rgba(255, 255, 255, 0.2)'],
						  borderColor: ['rgba(9, 132, 0, 1)'],
						  borderWidth: 2
					  },		
				  ]
					  },
			  options: {
				  scales: {
					  y: {
						  beginAtZero: true
					  }
				  }
			  }				
		  });
		  
		  //сортировка таблицы	
		  document.addEventListener('DOMContentLoaded', () => {
		  const getSort = ({ target }) => {
		  const order = (target.dataset.order = -(target.dataset.order || -1));
		  const index = [...target.parentNode.cells].indexOf(target);
		  const collator = new Intl.Collator(['en', 'ru'], { numeric: true });
		  const comparator = (index, order) => (a, b) => order * collator.compare(
			  a.children[index].innerHTML,
			  b.children[index].innerHTML
		  );

		  for(const tBody of target.closest('table').tBodies)
			  tBody.append(...[...tBody.rows].sort(comparator(index, order)));

		  for(const cell of target.parentNode.cells)
			  cell.classList.toggle('sorted', cell === target);
	  };
	  document.querySelectorAll('.table thead').forEach(tableTH => tableTH.addEventListener('click', () => getSort(event)));
  });
	  //Выпадающий список
				jQuery(($) => {
			$('.select').on('click', '.select__head', function () {
			if ($(this).hasClass('open')) {
				$(this).removeClass('open');
				$(this).next().fadeOut();
			} else {
				$('.select__head').removeClass('open');
				$('.select__list').fadeOut();
				$(this).addClass('open');
				$(this).next().fadeIn();
			}
			});

			$('.select').on('click', '.select__item', function () {
			$('.select__head').removeClass('open');
			$(this).parent().fadeOut();
			$(this).parent().prev().text($(this).text());
			$(this).parent().prev().prev().val($(this).text());
			});

			$(document).click(function (e) {
			if (!$(e.target).closest('.select').length) {
				$('.select__head').removeClass('open');
				$('.select__list').fadeOut();
			}
			});
			});

			//Табы
				jQuery(document).ready(function() {
				jQuery('.tabs .tab-links a').on('click', function(e) {
				var currentAttrValue = jQuery(this).attr('href');

			// Show/Hide Tabs
				jQuery('.tabs ' + currentAttrValue).fadeIn(400).siblings().hide();

				// Change/remove current tab to active
				jQuery(this).parent('li').addClass('active').siblings().removeClass('active');

				e.preventDefault();
				});
			});
	  </script>
</div>
</body>
</html>